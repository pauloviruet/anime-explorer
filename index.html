<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Anime Explorer</title>
  <style>
    :root {
      --bg: #111;
      --text: #fff;
      --card: #222;
      --link: #66aaff;
    }
    [data-theme="light"] {
      --bg: #f0f0f0;
      --text: #000;
      --card: #fff;
      --link: #0056cc;
    }body {
  margin: 0;
  padding: 0;
  font-family: 'Segoe UI', sans-serif;
  color: var(--text);
  background-color: var(--bg);
  transition: background 0.3s, color 0.3s;
}

a {
  color: var(--link);
  text-decoration: none;
}

#background-slideshow {
  position: fixed;
  top: 0; left: 0;
  width: 100%;
  height: 100%;
  z-index: -1;
  overflow: hidden;
}

#background-slideshow img {
  position: absolute;
  width: 100%;
  height: 100%;
  object-fit: cover;
  opacity: 0;
  transition: opacity 2s ease-in-out;
}

#background-slideshow img.active {
  opacity: 1;
}

.app {
  max-width: 960px;
  margin: 0 auto;
  padding: 10px;
  background: rgba(0, 0, 0, 0.7);
  border-radius: 12px;
  margin-top: 20px;
}

h1 {
  text-align: center;
  font-size: 2.2rem;
  margin-bottom: 20px;
}

select, input, button {
  font-size: 1rem;
  margin: 6px;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #444;
  background: var(--card);
  color: var(--text);
  max-width: 100%;
}

select[multiple] {
  height: 150px;
}

.controls {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  margin-bottom: 15px;
  padding: 0 10px;
}

#results {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 15px;
  margin-top: 20px;
}

.anime-card {
  background: var(--card);
  border-radius: 10px;
  padding: 10px;
  text-align: center;
  cursor: pointer;
  transition: 0.3s;
}

.anime-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}

.anime-card img {
  max-width: 100%;
  border-radius: 10px;
}

.loader {
  text-align: center;
  margin-top: 20px;
  font-style: italic;
}

.pagination {
  text-align: center;
  margin-top: 20px;
}

.pagination button {
  margin: 0 5px;
  padding: 8px 14px;
  background-color: var(--card);
  color: var(--text);
  border: 1px solid #444;
  border-radius: 6px;
  cursor: pointer;
}

@media (max-width: 600px) {
  h1 { font-size: 1.6rem; }
  button, input, select { font-size: 0.9rem; padding: 8px; }
  .controls {
    flex-direction: column;
    padding: 0 5px;
  }
  .anime-card h3 {
    font-size: 1rem;
  }
}

  </style>
</head>
<body data-theme="dark">
  <div class="app">
    <h1>Anime Explorer</h1>
    <div class="controls">
      <button onclick="toggleTheme()">Toggle Theme</button>
      <button onclick="toggleWebsite()">Switch Website</button>
      <input type="text" id="anime-search" placeholder="Type anime name..." onkeydown="if(event.key === 'Enter') handleSearch()" autocomplete="off"/>
      <select id="genre-select" multiple>
        <option value="Action">Action</option>
        <option value="Adventure">Adventure</option>
        <option value="Comedy">Comedy</option>
        <option value="Drama">Drama</option>
        <option value="Fantasy">Fantasy</option>
        <option value="Horror">Horror</option>
        <option value="Mystery">Mystery</option>
        <option value="Romance">Romance</option>
        <option value="Sci-Fi">Sci-Fi</option>
        <option value="Slice of Life">Slice of Life</option>
        <option value="Supernatural">Supernatural</option>
        <option value="Thriller">Thriller</option>
        <option value="Ecchi">Ecchi</option>
      </select>
      <button onclick="handleSearch()">Search</button>
      <button onclick="getRandomAnime()">Random Must Watch</button>
    </div><div class="loader" id="loader" style="display: none;">Loading...</div>
<div id="results"></div>
<div class="pagination" id="pagination"></div>

  </div>  <script>
    const loader = document.getElementById("loader");
    const resultsContainer = document.getElementById("results");
    const genreSelect = document.getElementById("genre-select");
    const animeInput = document.getElementById("anime-search");
    const paginationContainer = document.getElementById("pagination");
    let currentPage = 1;
    let currentWebsite = "hianimez";

    function toggleTheme() {
      const current = document.body.getAttribute("data-theme") || "dark";
      const next = current === "light" ? "dark" : "light";
      document.body.setAttribute("data-theme", next);
    }

    function toggleWebsite() {
      currentWebsite = currentWebsite === "hianimez" ? "animekai" : "hianimez";
      alert(`Switched to ${currentWebsite === "hianimez" ? "https://hianimez.to/" : "https://animekai.bz/"}`);
    }

    function getSelectedGenres() {
      return Array.from(genreSelect.selectedOptions).map(opt => opt.value);
    }

    function handleSearch() {
      currentPage = 1;
      searchAnime(currentPage);
    }

    async function searchAnime(page = 1) {
      const search = animeInput.value.trim();
      const genres = getSelectedGenres();

      loader.style.display = "block";
      resultsContainer.innerHTML = "";
      paginationContainer.innerHTML = "";

      const response = await fetch("https://graphql.anilist.co", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          query: `
            query ($search: String, $genres: [String], $page: Int) {
              Page(perPage: 12, page: $page) {
                pageInfo {
                  total
                  currentPage
                  lastPage
                }
                media(search: $search, genre_in: $genres, type: ANIME) {
                  id
                  title { romaji }
                  coverImage { large }
                  genres
                  siteUrl
                }
              }
            }`,
          variables: { search: search || null, genres: genres.length ? genres : null, page }
        })
      });

      const json = await response.json();
      loader.style.display = "none";
      const data = json.data.Page;
      displayAnime(data.media);
      renderPagination(data.pageInfo);
    }

    function displayAnime(list) {
      resultsContainer.innerHTML = list.map(anime => {
        const searchQuery = encodeURIComponent(anime.title.romaji);
        const animeUrl = currentWebsite === "animekai"
          ? `https://animekai.bz/browser?keyword=${searchQuery}`
          : `https://hianimez.to/search?keyword=${searchQuery}`;

        return `
          <div class="anime-card">
            <a href="${animeUrl}" target="_blank">
              <img src="${anime.coverImage.large}" alt="${anime.title.romaji}" />
              <h3>${anime.title.romaji}</h3>
              <p>${anime.genres.join(", ")}</p>
            </a>
          </div>
        `;
      }).join("");
    }

    function renderPagination(info) {
      if (info.lastPage <= 1) return;
      paginationContainer.innerHTML = `
        <button onclick="changePage(${info.currentPage - 1})" ${info.currentPage === 1 ? 'disabled' : ''}>Previous</button>
        Page ${info.currentPage} of ${info.lastPage}
        <button onclick="changePage(${info.currentPage + 1})" ${info.currentPage === info.lastPage ? 'disabled' : ''}>Next</button>
      `;
    }

    function changePage(page) {
      currentPage = page;
      searchAnime(currentPage);
    }

    async function getRandomAnime() {
      loader.style.display = "block";
      resultsContainer.innerHTML = "";
      paginationContainer.innerHTML = "";

      try {
        const randomPage = Math.floor(Math.random() * 50) + 1;

        const response = await fetch("https://graphql.anilist.co", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            query: `
              query ($page: Int) {
                Page(perPage: 50, page: $page) {
                  media(type: ANIME, isAdult: false) {
                    id
                    title { romaji }
                    coverImage { large }
                    genres
                    siteUrl
                  }
                }
              }
            `,
            variables: { page: randomPage }
          })
        });

        const json = await response.json();
        const animeList = json.data.Page.media;
        const shuffled = animeList.sort(() => 0.5 - Math.random());
        const randomPicks = shuffled.slice(0, 3);

        displayAnime(randomPicks);
      } catch (error) {
        console.error("Random anime fetch failed:", error);
        resultsContainer.innerHTML = `<p style="text-align:center; color:red;">Failed to fetch random anime.</p>`;
      } finally {
        loader.style.display = "none";
      }
    }

    // Optional Background Slideshow (uncomment if needed)
    // const slides = document.querySelectorAll("#background-slideshow img");
    // let index = 0;
    // setInterval(() => {
    //   slides[index].classList.remove("active");
    //   index = (index + 1) % slides.length;
    //   slides[index].classList.add("active");
    // }, 8000);
  </script></body>
</html>
